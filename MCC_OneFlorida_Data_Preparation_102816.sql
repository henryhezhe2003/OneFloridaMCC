	/* CREATE A TABLE HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, SEX, HISPANIC, RACE, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT); 'C_WT' IS USED FOR CALCULATING COMORBIDITY INDEX */DROP TABLE HCUP.dbo.PATIENT_CONDITION_ENCTYPE;PRINT 'table1, before delete' CREATE TABLE HCUP.dbo.PATIENT_CONDITION_ENCTYPE(PATID VARCHAR(64),AGE INT,AGE_GROUP VARCHAR(20),SEX VARCHAR(2),HISPANIC VARCHAR(2),RACE VARCHAR(2),ETHNICITY VARCHAR(50),CONDITION VARCHAR(150),ENC_TYPE VARCHAR(50),ADMIT_DATE DATE,C_WT INT);/* ACQUIRED HYPOTHYROIDISM */PRINT 'FINDING PATIENTS WITH ACQUIRED HYPOTHYROIDISM'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ACQUIRED HYPOTHYROIDISM' AS CONDITION, C.ENC_TYPE, C.ADMIT_DATE, 1 AS C_WTFROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('2440', '2441', '2442', '2443', '2448', '2449')) OR (C.DX_TYPE = '10' AND (REPLACE(C.DX, '.', '') IN ('E018', 'E02', 'E032', 'E033', 'E038', 'E039', 'E890'))));/* RESULT: 6765 *//* ACUTE MYOCARDIAL INFARCTION */PRINT 'FINDING PATIENTS WITH ACUTE MYOCARDIAL INFARCTION'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ACUTE MYOCARDIAL INFARCTION', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('41001', '41011', '41021', '41031', '41041', '41051', '41061', '41071', '41081', '41091')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('I2101', 'I2102', 'I2109', 'I2111', 'I2119', 'I2121', 'I2129', 'I213', 'I214', 'I220', 'I221', 'I222', 'I228', 'I229')));/* RESULT: 1502 *//* ALZHEIMERS DISEASE */PRINT 'FINDING PATIENTS WITH ALZHEIMERS DISEASE'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ALZHEIMERS DISEASE', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('3310')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('G300', 'G301', 'G308', 'G309')));/* RESULT: 1122 *//* ALZHEIMERS DISEASE AND RELATED DISORDERS OR SENILE DEMENTIA */PRINT 'FINDING PATIENTS WITH ALZHEIMERS DISEASE AND RELATED DISORDERS OR SENILE DEMENTIA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ALZHEIMERS DISEASE AND RELATED DISORDERS OR SENILE DEMENTIA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('3310', '33111', '33119', '3312', '3317', '2900', '29010', '29011', '29012', '29013', '29020', '29021', '2903', '29040', '29043', '2940', '29410', '29411', '29420', '29421', '2948', '797')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('F0150', 'F0151', 'F0280', 'F0281', 'F0390', 'F0391', 'F04', 'G132', 'G138', 'F05', 'F061', 'F068', 'G300', 'G301', 'G308', 'G309', 'G311', 'G312', 'G3101', 'G3109', 'G914', 'G94', 'R4181', 'R54')));/* RESULT: 6982 *//* ANEMIA */PRINT 'FINDING PATIENTS WITH ANEMIA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ANEMIA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('2800', '2801', '2808', '2809', '2810', '2811', '2812', '2813', '2814', '2818', '2819', '2820', '2821', '2822', '2823', '28240', '28241', '28242', '28243', '28244', '28245', '28246', '28247', '28249', '2825', '28260', '28261', '28262', '28263', '28264', '28268', '28269', '2830', '28310', '28311', '28319', '2832', '2839', '28401', '28409', '28411', '28412', '28419', '2842', '28481', '28489', '2850', '2851', '28521', '28522', '28529', '2853', '2858', '2859')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('D500', 'D501', 'D508', 'D509', 'D510', 'D511', 'D512', 'D513', 'D518', 'D519', 'D521', 'D528', 'D529', 'D530', 'D531', 'D532', 'D538', 'D539', 'D550', 'D551', 'D552', 'D553', 'D558', 'D559', 'D560', 'D562', 'D563', 'D564', 'D565', 'D568', 'D569', 'D5700', 'D5701', 'D5702', 'D571', 'D5720', 'D57211', 'D57212', 'D57219', 'D573', 'D5740', 'D57411', 'D57412', 'D57419', 'D5780', 'D57811', 'D57812', 'D57819', 'D580', 'D581', 'D582', 'D588', 'D589', 'D590', 'D591', 'D592', 'D593', 'D594', 'D595', 'D596', 'D598', 'D599', 'D600', 'D601', 'D608', 'D609', 'D6101', 'D6109', 'D611', 'D613', 'D61810', 'D61818', 'D6182', 'D6189', 'D619', 'D62', 'D63', 'D631', 'D638', 'D640', 'D641', 'D642', 'D643', 'D644', 'D6481', 'D6489', 'D649')));/*  RESULT: 11990 *//* ASTHMA */PRINT 'FINDING PATIENTS WITH ASTHMA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ASTHMA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('49300', '49301', '49302', '49310', '49311', '49312', '49320', '49321', '49322', '49381', '49382', '49390', '49391', '49392')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('J440', 'J441', 'J449', 'J4520', 'J4521', 'J4522', 'J4530', 'J4531', 'J4532', 'J4540', 'J4541', 'J4542', 'J4550', 'J4551', 'J4552', 'J45901', 'J45902', 'J45909', 'J45990', 'J45991', 'J45998')));/* RESULT: 3016 *//* ATRIAL FIBRILLATION */PRINT 'FINDING PATIENTS WITH ATRIAL FIBRILLATION'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ATRIAL FIBRILLATION', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('42731')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('I480', 'I482', 'I4891')));/* 7467 *//* BENIGN PROSTATIC HYPERPLASIA */PRINT 'FINDING PATIENTS WITH BENIGN PROSTATIC HYPERPLASIA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'BENIGN PROSTATIC HYPERPLASIA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('6000', '60001', '60011', '60020', '60021', '6003', '60090', '60091')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('N400', 'N401', 'N402', 'N403', 'N4283')));/* 1034 *//* CATARACT */PRINT 'FINDING PATIENTS WITH CATARACT'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'CATARACT', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('36601', '36602', '36603', '36604', '36609', '36610', '36612', '36613', '36614', '36615', '36616', '36617', '36618', '36619', '36620', '36621', '36622', '36623', '36630', '36645', '36646', '36650', '36651', '36652', '36653', '3668', '3669', '37926', '37939', '74330', '74331', '74332', '74333', 'V431')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ( 'H25001', 'H25012', 'H25031', 'H25032', 'H25033', 'H25039', 'H25041', 'H25042', 'H25043', 'H25049', 'H25091', 'H25092', 'H25093', 'H25099', 'H2510', 'H2511', 'H2512', 'H2513', 'H2520', 'H2521', 'H2522', 'H2523', 'H25811', 'H25812', 'H25813', 'H25819', 'H2589', 'H259', 'H26011', 'H26012', 'H26013', 'H26019', 'H26031', 'H26032', 'H26033', 'H26039', 'H26041', 'H26042', 'H26043', 'H26049', 'H26051', 'H26052', 'H26053', 'H26059', 'H26061', 'H26062', 'H26063', 'H26069', 'H2609', 'H26101', 'H26102', 'H26103', 'H26109', 'H26111', 'H26112', 'H26113', 'H26119', 'H26121', 'H26122', 'H26123', 'H26129', 'H26131', 'H26132', 'H26133', 'H26139', 'H2620', 'H2630', 'H2631', 'H2632', 'H2633', 'H2640', 'H26411', 'H26412', 'H26413', 'H26419', 'H26491', 'H26492', 'H26493', 'H26499', 'H268', 'H269', 'H2700', 'H2701', 'H2702', 'H2703', 'H278', 'H279', 'H4300', 'H4301', 'H4302', 'H4303', 'Q120', 'Z961')));/* 1113 *//* CHRONIC KIDNEY DISEASE */PRINT 'FINDING PATIENTS WITH CHRONIC KIDNEY DISEASE'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'CHRONIC KIDNEY DISEASE', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('01600', '01601', '01602', '01603', '01604', '01605', '01606', '0954', '1890', '1899', '2230', '23691', '24940', '24941', '25040', '25041', '25042', '25043','2714', '27410', '28311', '40301', '40311', '40391', '40402', '40403', '40412', '40413', '40492', '40493', '4401', '4421', '5724', '5800', '5804', '58081', '58089', '5809', '5810', '5811', '5812', '5813', '58181', '58189', '5819', '5820', '5821', '5822', '5824', '58281', '58289', '5829', '5830', '5831', '5832', '5834', '5836', '5837', '58381', '58389', '5839', '5845', '5846', '5847', '5848', '5849', '5851', '5852', '5853', '5854', '5855', '5856', '5859', '586', '587', '5880', '5881', '58881', '58889', '5889', '591', '75312', '75313', '75314', '75315', '75316', '75317', '75319', '75320', '75321', '75322', '75323', '75329', '7944')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('A1811', 'A5275', 'B520', 'C641', 'C642', 'C649', 'C689', 'D3000', 'D3001', 'D3002', 'D4100', 'D4101', 'D4102', 'D4110', 'D4111', 'D4112', 'D4120', 'D4121', 'D4122', 'D593', 'E0821', 'E0822', 'E0829', 'E0865', 'E0921', 'E0922', 'E0929', 'E1021', 'E1022', 'E1029', 'E1065', 'E1121', 'E1122', 'E1129', 'E1165', 'E1321', 'E1322', 'E1329', 'E748', 'I120', 'I1311', 'I132', 'I701', 'I722', 'K767', 'M1030', 'M10311', 'M10312', 'M10319', 'M10321', 'M10322', 'M10329', 'M10331', 'M10332', 'M10339', 'M10341', 'M10342', 'M10349', 'M10351', 'M10352', 'M10359', 'M10361', 'M10362', 'M10369', 'M10371', 'M10372', 'M10379', 'M1038', 'M1039', 'M3214', 'M3215', 'M3504', 'N000', 'N001', 'N002', 'N003', 'N004', 'N005', 'N006', 'N007', 'N008', 'N009', 'N010', 'N011', 'N012', 'N013', 'N014', 'N015', 'N016', 'N017', 'N018', 'N019', 'N020', 'N021', 'N022', 'N023', 'N024', 'N025', 'N026', 'N027', 'N028', 'N029', 'N030', 'N031', 'N032', 'N033', 'N034', 'N035', 'N036', 'N037', 'N038', 'N039', 'N040', 'N041', 'N042', 'N043', 'N044', 'N045', 'N046', 'N047', 'N048', 'N049', 'N050', 'N051', 'N052', 'N053', 'N054', 'N055', 'N056', 'N057', 'N058', 'N059', 'N060', 'N061', 'N062', 'N063', 'N064', 'N065', 'N066', 'N067', 'N068', 'N069', 'N070', 'N071', 'N072', 'N073', 'N074', 'N075', 'N076', 'N077', 'N078', 'N079', 'N08', 'N131', 'N132', 'N1330', 'N1339', 'N140', 'N141', 'N142', 'N143', 'N144', 'N150', 'N158', 'N159', 'N16', 'N170', 'N171', 'N172', 'N178', 'N179', 'N181', 'N182', 'N183', 'N184', 'N185', 'N186', 'N189', 'N19', 'N250', 'N251', 'N2581', 'N2589', 'N259', 'N261', 'N269', 'Q6102', 'Q6111', 'Q6119', 'Q612', 'Q613', 'Q614', 'Q615', 'Q618', 'Q620', 'Q622', 'Q6210', 'Q6211', 'Q6212', 'Q6231', 'Q6232', 'Q6239', 'R944')));/* 14189 *//* CHRONIC OBSTRUCTIVE PULMONARY DISEASE AND BRONCHIECTASIS */PRINT 'FINDING PATIENTS WITH CHRONIC OBSTRUCTIVE PULMONARY DISEASE AND BRONCHIECTASIS'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'CHRONIC OBSTRUCTIVE PULMONARY DISEASE AND BRONCHIECTASIS', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('490', '4910', '4911', '4918', '4919', '4920', '4928', '49120', '49121', '49122', '4940', '4941', '496')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('J40', 'J410', 'J411', 'J418', 'J42', 'J430', 'J431', 'J432', 'J438', 'J439', 'J440', 'J441', 'J449', 'J470', 'J471', 'J479')));/* 35085 *//* DEPRESSION */PRINT 'FINDING PATIENTS WITH DEPRESSION'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'DEPRESSION', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('29620', '29621', '29622', '29623', '29624', '29625', '29626', '29630', '29631', '29632', '29633', '29634', '29635', '29636', '29650', '29651', '29652', '29653', '29654', '29655', '29656', '29660', '29661', '29662', '29663', '29664', '29665', '29666', '29689', '2980', '3004', '3091', '311')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('F3130', 'F3131', 'F3132', 'F314', 'F315', 'F3160', 'F3161', 'F3162', 'F3163', 'F3164', 'F3175', 'F3176', 'F3177', 'F3178', 'F3181', 'F320', 'F321', 'F322', 'F323', 'F324', 'F325', 'F329', 'F330', 'F331', 'F332', 'F333', 'F3340', 'F3341', 'F3342', 'F339', 'F341', 'F4321')));/* 25923 *//* DIABETES */PRINT 'FINDING PATIENTS WITH DIABETES'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'DIABETES', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('24900', '24901', '24910', '24911', '24920', '24921', '24930', '24931', '24940', '24941', '24950', '24951', '24960', '24961', '24970', '24971', '24980', '24981', '24990', '24991', '25000', '25001', '25002', '25003', '25010', '25011', '25012', '25013', '25020', '25021', '25022', '25023', '25030', '25031', '25032', '25033', '25040', '25041', '25042', '25043', '25050', '25051', '25052', '25053', '25060', '25061', '25062', '25063', '25070', '25071', '25072', '25073', '25080', '25081', '25082', '25083', '25090', '25091', '25092', '25093', '3572', '36201', '36202', '36203', '36204', '36205', '36206', '36641')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('E0800','E0801','E0810','E0811','E0821','E0822','E0829','E08311','E08319','E08321','E08329','E08331','E08339','E08341','E08349','E08351','E08359','E0836','E0839','E0840','E0841','E0842','E0843','E0844','E0849','E0851','E0852','E0859','E08610','E08618','E08620','E08621','E08622','E08628','E08630','E08638','E08641','E08649','E0865','E0869','E088','E089','E0900','E0901','E0910','E0911','E0921','E0922','E0929','E09311','E09319','E09321','E09329','E09331','E09339','E09341','E09349','E09351','E09359','E0936','E0939','E0940','E0941','E0942','E0943','E0944','E0949','E0951','E0952','E0959','E09610','E09618','E09620','E09621','E09622','E09628','E09630','E09638','E09641','E09649','E0965','E0969','E098','E099','E1010','E1011','E1021','E1022','E1029','E10311','E10319','E10321','E10329','E10331','E10339','E10341','E10349','E10351','E10359','E1036','E1039','E1040','E1041','E1042','E1043','E1044','E1049','E1051','E1052','E1059','E10610','E10618','E10620','E10621','E10622','E10628','E10630','E10638','E10641','E10649','E1065','E1069','E108','E109','E1100','E1101','E1121','E1122','E1129','E11311','E11319','E11321','E11329','E11331','E11339','E11341','E11349','E11351','E11359','E1136','E1139','E1140','E1141','E1142','E1143','E1144','E1149','E1151','E1152','E1159','E11610','E11618','E11620','E11621','E11622','E11628','E11630','E11638','E11641','E11649','E1165','E1169','E118','E119','E1300','E1301','E1310','E1311','E1321','E1322','E1329','E13311','E13319','E13321','E13329','E13331','E13339','E13341','E13349','E13351','E13359','E1336','E1339','E1340','E1341','E1342','E1343','E1344','E1349','E1351','E1352','E1359','E13610','E13618','E13620','E13621','E13622','E13628','E13630','E13638','E13641','E13649','E1365','E1369','E138','E139')));/* 11854 *//* GLAUCOMA */PRINT 'FINDING PATIENTS WITH GLAUCOMA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'GLAUCOMA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('36285','36500','36501','36502','36503','36504','36510','36511','36512','36513','36515','36520','36521','36522','36523','36524','36531','36532','36541','36542','36543','36551','36552','36559','36560','36561','36562','36563','36564','36565','36581','36582','36583','36589','3659','37714')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('H3589','H40001','H40002','H40003','H40009','H40011','H40012','H40013','H40019','H40031','H40032','H40033','H40039','H40041','H40042','H40043','H40049','H40051','H40052','H40053','H40059','H4010X0','H4010X1','H4010X2','H4010X3','H4010X4','H4011X0','H4011X1','H4011X2','H4011X3','H4011X4','H401210','H401211','H401212','H401213','H401214','H401220','H401221','H401222','H401223','H401224','H401230','H401231','H401232','H401233','H401234','H401290','H401291','H401292','H401293','H401294','H401310','H401311','H401312','H401313','H401314','H401320','H401321','H401322','H401323','H401324','H401330','H401331','H401332','H401333','H401334','H401390','H401391','H401392','H401393','H401394','H401410','H401411','H401412','H401413','H401414','H401420','H401421','H401422','H401423','H401424','H401430','H401431','H401432','H401433','H401434','H401490','H401491','H401492','H401493','H401494','H40151','H40152','H40153','H40159','H4020X0','H4020X1','H4020X2','H4020X3','H4020X4','H40211','H40212','H40213','H40219','H402210','H402211','H402212','H402213','H402214','H402220','H402221','H402222','H402223','H402224','H402230','H402231','H402232','H402233','H402234','H402290','H402291','H402292','H402293','H402294','H40231','H40232','H40233','H40239','H40241','H40242','H40243','H40249','H4030X0','H4030X1','H4030X2','H4030X3','H4030X4','H4031X0','H4031X1','H4031X2','H4031X3','H4031X4','H4032X0','H4032X1','H4032X2','H4032X3','H4032X4','H4033X0','H4033X1','H4033X2','H4033X3','H4033X4','H4040X0','H4040X1','H4040X2','H4040X3','H4040X4','H4041X0','H4041X1','H4041X2','H4041X3','H4041X4','H4042X0','H4042X1','H4042X2','H4042X3','H4042X4','H4043X0','H4043X1','H4043X2','H4043X3','H4043X4','H4050X0','H4050X1','H4050X2','H4050X3','H4050X4','H4051X0','H4051X1','H4051X2','H4051X3','H4051X4','H4052X0','H4052X1','H4052X2','H4052X3','H4052X4','H4053X0','H4053X1','H4053X2','H4053X3','H4053X4','H4060X0','H4060X1','H4060X2','H4060X3','H4060X4','H4061X0','H4061X1','H4061X2','H4061X3','H4061X4','H4062X0','H4062X1','H4062X2','H4062X3','H4062X4','H4063X0','H4063X1','H4063X2','H4063X3','H4063X4','H40811','H40812','H40813','H40819','H40821','H40822','H40823','H40829','H40831','H40832','H40833','H40839','H4089','H409','H47231','H47232','H47233','H47239')));/* 1548 *//* HEART FAILURE */PRINT 'FINDING PATIENTS WITH HEART FAILURE'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'HEART FAILURE', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('39891', '40201', '40211', '40291', '40401', '40403', '40411', '40413', '40491', '40493', '4280', '4281', '42820', '42821', '42822', '42823', '42830', '42831', '42832', '42833', '42840', '42841', '42842', '42843', '4289')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('I0981', 'I110', 'I130', 'I132', 'I501', 'I5020', 'I5021', 'I5022', 'I5023', 'I5030', 'I5031', 'I5032', 'I5033', 'I5040', 'I5041', 'I5042', 'I5043', 'I509')));/* 5700 *//* HIP/PELVIC FRACTURE */PRINT 'FINDING PATIENTS WITH HIP/PELVIC FRACTURE'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'HIP/PELVIC FRACTURE', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('73314','73315','73396','73397','73398','8080','8081','8082','8083','80841','80842','80843','80844','80849','80851','80852','80853','80854','80859','8088','8089','82000','82001','82002','82003','82009','82010','82011','82012','82013','82019','82020','82021','82022','82030','82031','82032','8208','8209')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('M80051A','M80052A','M80059A','M80851A','M80852A','M80859A','M84350A','M84351A','M84352A','M84353A','M84359A','M84451A','M84452A','M84453A','M84459A','M84551A','M84552A','M84553A','M84559A','M84651A','M84652A','M84653A','M84659A','S32301A','S32301B','S32302A','S32302B','S32309A','S32309B','S32311A','S32311B','S32312A','S32312B','S32313A','S32313B','S32314A','S32314B','S32315A','S32315B','S32316A','S32316B','S32391A','S32391B','S32392A','S32392B','S32399A','S32399B','S32401A','S32401B','S32402A','S32402B','S32409A','S32409B','S32411A','S32411B','S32412A','S32412B','S32413A','S32413B','S32414A','S32414B','S32415A','S32415B','S32416A','S32416B','S32421A','S32421B','S32422A','S32422B','S32423A','S32423B','S32424A','S32424B','S32425A','S32425B','S32426A','S32426B','S32431A','S32431B','S32432A','S32432B','S32433A','S32433B','S32434A','S32434B','S32435A','S32435B','S32436A','S32436B','S32441A','S32441B','S32442A','S32442B','S32443A','S32443B','S32444A','S32444B','S32445A','S32445B','S32446A','S32446B','S32451A','S32451B','S32452A','S32452B','S32453A','S32453B','S32454A','S32454B','S32455A','S32455B','S32456A','S32456B','S32461A','S32461B','S32462A','S32462B','S32463A','S32463B','S32464A','S32464B','S32465A','S32465B','S32466A','S32466B','S32471A','S32471B','S32472A','S32472B','S32473A','S32473B','S32474A','S32474B','S32475A','S32475B','S32476A','S32476B','S32481A','S32481B','S32482A','S32482B','S32483A','S32483B','S32484A','S32484B','S32485A','S32485B','S32486A','S32486B','S32491A','S32491B','S32492A','S32492B','S32499A','S32499B','S32501A','S32501B','S32502A','S32502B','S32509A','S32509B','S32511A','S32511B','S32512A','S32512B','S32519A','S32519B','S32591A','S32591B','S32592A','S32592B','S32599A','S32599B','S32601A','S32601B','S32602A','S32602B','S32609A','S32609B','S32611A','S32611B','S32612A','S32612B','S32613A','S32613B','S32614A','S32614B','S32615A','S32615B','S32616A','S32616B','S32691A','S32691B','S32692A','S32692B','S32699A','S32699B','S32810A','S32810B','S32811A','S32811B','S3282XA','S3282XB','S3289XA','S3289XB','S329XXA','S329XXB','S72001A','S72001B','S72001C','S72002A','S72002B','S72002C','S72009A','S72009B','S72009C','S72011A','S72011B','S72011C','S72012A','S72012B','S72012C','S72019A','S72019B','S72019C','S72021A','S72021B','S72021C','S72022A','S72022B','S72022C','S72023A','S72023B','S72023C','S72024A','S72024B','S72024C','S72025A','S72025B','S72025C','S72026A','S72026B','S72026C','S72031A','S72031B','S72031C','S72032A','S72032B','S72032C','S72033A','S72033B','S72033C','S72034A','S72034B','S72034C','S72035A','S72035B','S72035C','S72036A','S72036B','S72036C','S72041A','S72041B','S72041C','S72042A','S72042B','S72042C','S72043A','S72043B','S72043C','S72044A','S72044B','S72044C','S72045A','S72045B','S72045C','S72046A','S72046B','S72046C','S72051A','S72051B','S72051C','S72052A','S72052B','S72052C','S72059A','S72059B','S72059C','S72061A','S72061B','S72061C','S72062A','S72062B','S72062C','S72063A','S72063B','S72063C','S72064A','S72064B','S72064C','S72065A','S72065B,S72065C','S72066A','S72066B','S72066C','S72091A','S72091B','S72091C','S72092A','S72092B','S72092C','S72099A','S72099B','S72099C','S72101A','S72101B','S72101C','S72102A','S72102B','S72102C','S72109A','S72109B','S72109C','S72111A','S72111B','S72111C','S72112A','S72112B','S72112C','S72113A','S72113B','S72113C','S72114A','S72114B','S72114C','','S72115A','S72115B','S72115C','S72116A','S72116B','S72116C','S72121A','S72121B','S72121C','S72122A','S72122B','S72122C','S72123A','S72123B','S72123C','S72124A','S72124B','S72124C','S72125A','S72125B','S72125C','S72126A','S72126B','S72126C','S72131A','S72131B','S72131C','S72132A','S72132B','S72132C','S72133A','S72133B','S72133C','S72134A','S72134B','S72134C','S72135A','S72135B','S72135C','S72136A','S72136B','S72136C','S72141A','S72141B','S72141C','S72142A','S72142B','S72142C','S72143A','S72143B','S72143C','S72144A','S72144B','S72144C','S72145A','S72145B','S72145C','S72146A','S72146B','S72146C','S7221XA','S7221XB','S7221XC','S7222XA','S7222XB','S7222XC','S7223XA','S7223XB','S7223XC','S7224XA','S7224XB','S7224XC','S7225XA','S7225XB','S7225XC','S7226XA','S7226XB','S7226XC','S79001A','S79002A','S79009A','S79011A','S79012A','S79019A','S79091A','S79092A','S72099A')));/* 1187 *//* HYPERLIPIDEMIA */PRINT 'FINDING PATIENTS WITH HYPERLIPIDEMIA'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'HYPERLIPIDEMIA', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('2720', '2721', '2722', '2723', '2724')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('E780', 'E781', 'E782', 'E783', 'E784', 'E785')));/* 18731 *//* HYPERTENSION */PRINT 'FINDING PATIENTS WITH HYPERTENSION'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'HYPERTENSION', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('36211','4010','4011','4019','40200','40201','40210','40211','40290','40291','40300','40301','40310','40311','40390','40391','40400','40401','40402','40403','40410','40411','40412','40413','40490','40491','40492','40493','40501','40509','40511','40519','40591','40599','4372')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('H35031','H35032','H35033','H35039','I10','I110','I119','I120','I129','I130','I1310','I1311','I132','I150','I151','I152','I158','I159','I674','N262')));/* 67828 *//* ISCHEMIC HEART DISEASE */PRINT 'FINDING PATIENTS WITH ISCHEMIC HEART DISEASE'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ISCHEMIC HEART DISEASE', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('41000','41001','41002','41010','41011','41012','41020','41021','41022','41030','41031','41032','41040','41041','41042','41050','41051','41052','41060','41061','41062','41070','41071','41072','41080','41081','41082','41090','41091','41092','4110','4111','41181','41189','412','4130','4131','4139','41400','41401','41402','41403','41404','41405','41406','41407','41412','4142','4143','4144','4148','4149')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('I200','I201','I208','I209','I2101','I2102','I2109','I2111','I2119','I2121','I2129','I213','I214','I220','I221','I222','I228','I229','I240','I241','I248','I249','I2510','I25110','I25111','I25118','I25119','I252','I2542','I255','I256','I25700','I25701','I25708','I25709','I25710','I25711','I25718','I25719','I25720','I25721','I25728','I25729','I25730','I25731','I25738','I25739','I25750','I25751','I25758','I25759','I25760','I26761','I25768','I25769','I25790','I25791','I25798','I25799','I25810','I25811','I25812','I2582','I2583','I2584','I2589','I259')));/* 22840 *//* OSTEOPOROSIS */PRINT 'FINDING PATIENTS WITH OSTEOPOROSIS'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'OSTEOPOROSIS', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('73300', '73301', '73302', '73303', '73309')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('M810', 'M816', 'M818')));/* 4284 *//* RA/OA (RHEUMATOID ARTHRITIS/OSTEOARTHRITIS) */PRINT 'FINDING PATIENTS WITH RA/OA (RHEUMATOID ARTHRITIS/OSTEOARTHRITIS)'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'RHEUMATOID ARTHRITIS/OSTEOARTHRITIS', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('7140','7141','7142','71430','71431','71432','71433','71500','71504','71509','71510','71511','71512','71513','71514','71515','71516','71517','71518','71520','71521','71522','71523','71524','71525','71526','71527','71528','71530','71531','71532','71533','71534','71535','71536','71537','71538','71580','71589','71590','71591','71592','71593','71594','71595','71596','71597','71598','7200','7210','7211','7212','7213','72190','72191')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('M0500','M05011','M05012','M05019','M05021','M05022','M05029','M05031','M05032','M05039','M05041','M05042','M05049','M05051','M05052','M05059','M05061','M05062','M05069','M05071','M05072','M05079','M0509','M0520','M05211','M05212','M05219','M05221','M05222','M05229','M05231','M05232','M05239','M05241','M05242','M05249','M05251','M05252','M05259','M05261','M05262','M05269','M05271','M05272','M05279','M0529','M0530','M05311','M05312','M05319','M05321','M05322','M05329','M05331','M05332','M05339','M05341','M05342','M05349','M05351','M05352','M05359','M05361','M05362','M05369','M05371','M05372','M05379','M0539','M0540','M05411','M05412','M05419','M05421','M05422','M05429','M05431','M05432','M05439','M05441','M05442','M05449','M05451','M05452','M05459','M05461','M05462','M05469','M05471','M05472','M05479','M0549','M0550','M05511','M05512','M05519','M05521','M05522','M05529','M05531','M05532','M05539','M05541','M05542','M05549','M05551','M05552','M05559','M05561','M05562','M05569','M05571','M05572','M05579','M0559','M0560','M05611','M05612','M05619','M05621','M05622','M05629','M05631','M05632','M05639','M05641','M05642','M05649','M05651','M05652','M05659','M05661','M05662','M05669','M05671','M05672','M05679','M0569','M0570','M05711','M05712','M05719','M05721','M05722','M05729','M05731','M05732','M05739','M05741','M05742','M05749','M05751','M05752','M05759','M05761','M05762','M05769','M05771','M05772','M05779','M0579','M0580','M05811','M05812','M05819','M05821','M05822','M05829','M05831','M05832','M05839','M05841','M05842','M05849','M05851','M05852','M05859','M05861','M05862','M05869','M05871','M05872','M05879','M0589','M059','M0600','M06011','M06012','M06019','M06021','M06022','M06029','M06031','M06032','M06039','M06041','M06042','M06049','M06051','M06052','M06059','M06061','M06062','M06069','M06071','M06072','M06079','M0608','M0609','M061','M0620','M06211','M06212','M06219','M06221','M06222','M06229','M06231','M06232','M06239','M06241','M06242','M06249','M06251','M06252','M06259','M06261','M06262','M06269','M06271','M06272','M06279','M0628','M0629','M0630','M06311','M06312','M06319','M06321','M05322','M06329','M06331','M06332','M06339','M06341','M06342','M06349','M06351','M06352','M06359','M06361','M06362','M06369','M06371','M06372','M06379','M0638','M0639','M0680','M06811','M06812','M06819','M06821','M06822','M06829','M06831','M06832','M06839','M06841','M06842','M06849','M06851','M06852','M06859','M06861','M06862','M06869','M06871','M06872','M06879','M0688','M0689','M069','M0800','M08011','M08012','M08019','M08021','M08022','M08029','M08031','M08032','M08039','M08041','M08042','M08049','M08051','M08052','M08059','M08061','M08062','M08069','M08071','M08072','M08079','M0808','M0809','M081','M0820','M08211','M08212','M08219','M08221','M08222','M08229','M08231','M08232','M08239','M08241','M08242','M08249','M08251','M08252','M08259','M08261','M08262','M08269','M08271','M08272','M08279','M0828','M0829','M083','M0840','M08411','M08412','M08419','M08421','M08422','M08429','M08431','M08432','M08439','M08441','M08442','M08,449','M08451','M08452','M08459','M08461','M08462','M08469','M08471','M08472','M08479','M0848','M0880','M08811','M08812','M08819','M08821','M08822','M08829','M08831','M08832','M08839','M08841','M08842','M08849','M08851','M08852','M08859','M08861','M08862','M08869','M08871','M08872','M08879','M0888','M0889','M0890','M08911','M08912','M08919','M08921','M08922','M08929','M08931','M08932','M08939','M08941','M08942','M08949','M08951','M08952','M08959','M08961','M08962','M08969','M08971','M08972','M08979','M0898','M0899','M150','M151','M152','M153','M154','M158','M159','M160','M1610','M1611','M1612','M162','M1630','M1631','M1632','M164','M1650','M1651','M1652','M166','M167','M169','M170','M1710','M1711','M1712','M172','M1730','M1731','M1732','M174','M175','M179','M180','M1810','M1811','M1812','M182','M1830','M1831','M1832','M184','M1850','M1851','M1852','M189','M19011','M19012','M19019','M19021','M19022','M19029','M19031','M19032','M19039','M19041','M19042','M19049','M19071','M19072','M19079','M19111','M19112','M19119','M19121','M19122','M19129','M19131','M19132','M19139','M19141','M19142','M19149','M19171','M19172','M19179','M19211','M19212','M19219','M19221','M19222','M19229','M19231','M19232','M19239','M19241','M19242','M19249','M19271','M19272','M19279','M1990','M1991','M1992','M1993','M450','M451','M452','M453','M454','M455','M456','M457','M458','M459','M47011','M47012','M47013','M47014','M47015','M47016','M47019','M47021','M47022','M47029','M4710','M4711','M4712','M4713','M4720','M4721','M4722','M4723','M4724','M4725','M4726','M4727','M4728','M47811','M47812','M47813','M47814','M47815','M47816','M47817','M47818','M47819','M47891','M47892','M47893','M47894','M47895','M47896','M47897','M47898','M47899','M479','M488X1','M488X2','M488X3','M488X4','M488X5','M488X6','M488X7','M488X8','M488X9')));/* 7865 *//* STROKE/TRANSIENT ISCHEMIC ATTACK */PRINT 'FINDING PATIENTS WITH STROKE/TRANSIENT ISCHEMIC ATTACK'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'STROKE/TRANSIENT ISCHEMIC ATTACK', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('430','431','43301','43311','43321','43331','43381','43391','43400','43401','43410','43411','43490','43491','4350','4351','4353','4358','4359','436','99702')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('G450','G451','G452','G458','G459','G460','G461','G462','G9731','G9732','I6000','I6001','I6002','I6010','I6011','I6012','I6020','I6021','I6022','I6030','I6031','I6032','I604','I6050','I6051','I6052','I606','I607','I608','I609','I610','I611','I612','I613','I614','I615','I616','I618','I619','I6300','I6302','I63011','I63012','I63019','I63031','I63032','I63039','I6309','I6310','I63111','I63112','I63119','I6312','I63131','I63132','I63139','I6319','I6320','I63211','I63212','I63219','I6322','I63231','I63232','I63239','I6329','I6330','I63311','I63312','I63319','I63321','I63322','I63329','I63331','I63332','I63339','I63341','I63342','I63349','I6339','I6340','I63411','I63412','I63419','I63421','I63422','I63429','I63431','I63432','I63439','I63441','I63442','I63449','I6349','I6350','I63511','I63512','I63519','I63521','I63522','I63529','I63531','I63532','I63539','I63541','I63542','I63549','I6359','I636','I638','I639','I6601','I6602','I6603','I6609','I6611','I6612','I6613','I6619','I6621','I6622','I6623','I6629','I663','I668','I669','I67841','I67848','I6789','I97810','I97811','I97820','I97821'))) AND C.PATID NOT IN (SELECT E.PATID FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] E WHERE (E.DX_TYPE = '9' AND (REPLACE(E.DX, ',', '') BETWEEN '800' AND '804.9' OR REPLACE(E.DX, ',', '') BETWEEN '850' AND '854.1')) OR (E.DX_TYPE = '10' AND REPLACE(E.DX, ',', '') IN ('S0190XA','S020XXA','S020XXB','S0210XA','S0210XB','S02110A','S02111A','S02112A','S0113A','S02110B','S02111B','S02112B','S02113B','S02118B','S02119A','S02119B','S0219XA','S0219XB','S022XXA','S022XXB','S023XXA','S023XXB','S02400A','S02401A','S02402A','S02400B','S02402B','S02411A','S02412A','S02413A','S02411B','S02412B','S02413B','S0242XA','S0242XB','S02600A','S02600B','S02609A','S02609B','S0261XA','S0262XA','S0263XA','S0264XA','S0265XA','S0266XA','S0267XA','S0269XA','S0261XB','S0262XB','S0263XB','S0264XB','S0265XB','S0266XB','S0267XB','S0269XB','S028XXA','S028XXB','S0291XA','S0291XB','S0292XA','S0292XB','S060X0A','S060X1A','S060X2A','S060X3A','S060X4A','S060X5A','S060X6A','S060X7A','S060X8A','S060X9A','S061X0A','S061X1A','S061X2A','S061X3A','S061X4A','S061X5A','S061X6A','S061X7A','S061X8A','S061X9A','S062X0A','S062X1A','S062X2A','S062X3A','S062X4A','S062X5A','S062X6A','S062X7A','S062X8A','S062X9A','S06300A','S06301A','S06302A','S06303A','S06304A','S06305A','S06306A','S06307A','S06308A','S06309A','S06310A','S06311A','S06312A','S06313A','S06314A','S06315A','S06316A','S06317A','S06318A','S06319A','S06320A','S06321A','S06322A','S06323A','S06324A','S06325A','S06326A','S06327A','S06328A','S06329A','S06330A','S06331A','S06332A','S06333A','S06334A','S06335A','S06336A','S06337A','S06338A','S06339A','S06340A','S06341A','S06342A','S06343A','S06344A','S06345A','S06346A','S06347A','S06348A','S06349A','S06350A','S06351A','S06352A','S06353A','S06354A','S06355A','S06356A','S06357A','S06358A','S06359A','S06360A','S06361A','S06362A','S06363A','S06364A','S06365A','S06366A','S06367A','S06368A','S06369A','S06370A','S06371A','S06372A','S06373A','S06374A','S06375A','S06376A','S06377A','S06378A','S06379A','S06380A','S06381A','S06382A','S06383A','S06384A','S06385A','S06386A','S06387A','S06388A','S06389A','S064X0A','S064X1A','S064X2A','S064X3A','S064X4A','S064X5A','S064X6A','S064X7A','S064X8A','S064X9A','S065X0A','S065X1A','S065X2A','S065X3A','S065X4A','S065X5A','S065X6A','S065X7A','S065X8A','S065X9A','S066X0A','S066X1A','S066X2A','S066X3A','S066X4A','S066X5A','S066X6A','S066X7A','S066X8A','S066X9A','S06810A','S06811A','S06812A','S06813A','S06814A','S06815A','S06816A','S06817A','S06818A','S06819A','S06820A','S06821A','S06822A','S06823A','S06824A','S06825A','S06826A','S06827A','S06828A','S06829A','S06890A','S06891A','S06892A','S06893A','S06894A','S06895A','S06896A','S06897A','S06898A','S06899A','S069X0A','S069X1A','S069X2A','S069X3A','S069X4A','S0695A','S069X6A','S069X7A','S069X8A','S069X9A','Z5189')));/* 6850 *//*  FEMALE / MALE BREAST CANCER */PRINT 'FINDING PATIENTS WITH FEMALE / MALE BREAST CANCER'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'FEMALE / MALE BREAST CANCER', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('1740', '1741', '1742', '1743', '1744', '1745', '1746', '1748', '1749', '1750', '1759', '2330', 'V103')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('C50011','C50012','C50019','C50021','C50022','C50029','C50111','C50112','C50119','C50121','C50122','C50129','C50211','C50212','C50219','C50221','C50222','C50229','C50311','C50312','C50319','C50321','C50322','C50329','C50411','C50412','C50419','C40421','C50422','C50429','C50511','C50512','C50519','C50521','C50522','C50529','C50611','C50612','C50619','C50621','C50622','C50629','C50811','C50812','C50819','C50821','C50822','C50829','C50911','C50912','C50919','C50921','C50922','C50929','D0500','D0501','D0502','D0510','D0511','D0512','D0580','D0581','D0582','D0590','D0591','D0592','Z853')));/* 2208 *//* COLORECTAL CANCER */PRINT 'FINDING PATIENTS WITH COLORECTAL CANCER'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'COLORECTAL CANCER', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('1530', '1531', '1532', '1533', '1534', '1535', '1536', '1537', '1538', '1539', '1540', '1541', '2303', '2304', 'V1005', 'V1006' )) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('C180', 'C181', 'C182', 'C183', 'C184', 'C185', 'C186', 'C187', 'C188', 'C189', 'C19', 'C20', 'D010', 'D011', 'D012', 'Z85038', 'Z85048')));/* 1279 *//* PROSTATE CANCER */PRINT 'FINDING PATIENTS WITH PROSTATE CANCER'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'PROSTATE CANCER', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('185', '2334', 'V1046')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('C61', 'D075', 'Z8546')));/* 9603 *//* LUNG CANCER */PRINT 'FINDING PATIENTS WITH LUNG CANCER'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'LUNG CANCER', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('1622', '1623', '1624', '1625', '1628', '1629', '2312', 'V1011')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('C3400', 'C3401', 'C3402', 'C3410', 'C3411', 'C3412', 'C342', 'C3430', 'C3431', 'C3432', 'C3480', 'C3481', 'C3482', 'C3490', 'C3491', 'C3492', 'D0220', 'D0221', 'D0222', 'Z85118')));/* 1010 *//* ENDOMETRIAL CANCER */PRINT 'FINDING PATIENTS WITH ENDOMETRIAL CANCER'INSERT INTO HCUP.dbo.PATIENT_CONDITION_ENCTYPE (PATID, AGE, AGE_GROUP, SEX, HISPANIC, RACE, ETHNICITY, CONDITION, ENC_TYPE, ADMIT_DATE, C_WT)SELECT DISTINCT C.PATID AS PATID, DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) AS AGE, 'AGE_GROUP N/A', D.SEX, D.HISPANIC, D.RACE, 'ETHNICITY', 'ENDOMETRIAL CANCER', C.ENC_TYPE, C.ADMIT_DATE, 1FROM [ONEFLDW_PROD].[DBO].[DIAGNOSIS] C, [ONEFLDW_PROD].[DBO].[DEMOGRAPHIC] DWHERE  C.PATID = D.PATIDAND DATEDIFF(YEAR, D.BIRTH_DATE, C.ADMIT_DATE) >= 65AND ((C.DX_TYPE = '09' AND REPLACE(C.DX, '.', '') IN ('1820', '2332', 'V1042')) OR (C.DX_TYPE = '10' AND REPLACE(C.DX, '.', '') IN ('C541', 'C542', 'C543', 'C549', 'D070', 'Z8542')));/* ASSIGNING VALUES TO AGE GROUP */UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET AGE_GROUP ='65_74' WHERE AGE >= 65 AND AGE <= 74;UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET AGE_GROUP ='75_84' WHERE AGE >= 75 AND AGE <= 84;UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET AGE_GROUP ='ABOVE_85' WHERE AGE >= 85;/* ASSIGNING VALUES TO ETHNICITY */UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET ETHNICITY ='NON_HISPANIC_WHITE' WHERE RACE = '05' AND HISPANIC ='N';UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET ETHNICITY ='NON_HISPANIC_BLACK' WHERE RACE = '03' AND HISPANIC ='N';UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET ETHNICITY ='ASIAN_PI' WHERE HISPANIC ='N' AND (RACE = '02' OR RACE = '04');UPDATE HCUP.dbo.PATIENT_CONDITION_ENCTYPE SET ETHNICITY ='HISPANIC' WHERE HISPANIC ='Y';